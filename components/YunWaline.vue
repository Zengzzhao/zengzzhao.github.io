<script lang="ts" setup>
import { onMounted } from 'vue'
import { useAddonWaline } from 'valaxy-addon-waline'

const addon = useAddonWaline()
onMounted(() => {
  const email = document.getElementById('wl-mail');
  const textarea=document.getElementById('wl-edit');
  textarea.placeholder=`üìßÊú¨Á´ôÂ∑≤ÂºÄÂêØÈÇÆ‰ª∂ÈÄöÁü•ÔºåÂõûÂ§çÊÇ®ËØÑËÆ∫ÁöÑÂêåÊó∂‰ºöemailÂà∞ÊÇ®ÁöÑÈÇÆÁÆ±ÔºåÂõ†Ê≠§ËØ∑Á°Æ‰øùÈÇÆÁÆ±ÁöÑÊúâÊïàÊÄß`;
  textarea.style.height='150px';
  const chatPeople=document.getElementsByClassName('chatPeople')[0]
  // ËæìÂÖ•qqÈÇÆÁÆ±ÂêéÂ§¥ÂÉèËΩ¨Êç¢
  email.onblur = () => {
    const text = email.value;
    let qqImg;
    if (!text) {
      qqImg = 'https://s2.loli.net/2025/01/11/cyAaklriH9bGE4g.webp'
    } else {
      const regex = /^([^@]+)/;
      const qq = text.match(regex)[1];
      qqImg = `https://thirdqq.qlogo.cn/g?b=sdk&nk=${qq}&s=140 `;
    }
    const img = document.getElementById('img') as HTMLImageElement;
    if (img) {
      img.src = qqImg;
    }
  }
  // ËæìÂÖ•ËØÑËÆ∫ÂêéÂè§È£éÊ∞¥Â¢®‰∫∫Áâ©Ê∂àÂ§±
  textarea.style.overflow='hidden';
  textarea.onfocus=()=>{
    chatPeople.style.top = '50px';
    
  }
})

</script>

<template>
  <div class="container">
    <div class="comment-tooltip text-center"><span>Ë¶Å‰∏çË¶ÅÂíåÊàëËØ¥‰∫õ‰ªÄ‰πàÔºü</span><br></div>
    <WalineClient w="full" :options="addon.options" />
    <div class="avatar">
      <img id="img" src="https://s2.loli.net/2025/01/11/cyAaklriH9bGE4g.webp" alt="">
    </div>
    <div class="chatPeople">
      <img src="https://s2.loli.net/2025/01/11/BejOJo8RdzLaGVZ.jpg" alt="">
    </div>
  </div>
</template>

<style scoped lang="less">
.container {
  position: relative;

  .comment-tooltip {
    font-size: .8rem;
    color: #333333;
    padding: .5rem;
    border: 1px solid #f0f0f0;
    margin-bottom: 1rem;
    width: 100%;
    border-radius: 10px;
  }

  .avatar {
    position: absolute;
    top: 63px;
    left: -52px;

    img {
      width: 52px;
      height: 52px;
      border-radius: 50%;
    }
  }
  .chatPeople{
    position: absolute;
    left: 23px;
    top: 145px;
    img{
      height: 120px;
    }
  }
}
</style>